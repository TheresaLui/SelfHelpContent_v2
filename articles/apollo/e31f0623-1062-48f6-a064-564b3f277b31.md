<properties
  pagetitle="Apollo_WindowsTroubleshootNSG"
  description="Apollo articles for Windows VM Troubleshoot NSG"
  service=""
  resource=""
  ms.author="chelche"
  selfhelptype="apollo"
  supporttopicids="9e9faedb-7764-448b-244a-14eca26f5362"
  productpesids="14749"
  cloudenvironments="blackforest,fairfax,mooncake,public,usnat,ussec"
  disableclouds=""
  articleid="e31f0623-1062-48f6-a064-564b3f277b31"
  ownershipid="Compute_VirtualMachines" />
<insight>
    <executionText>We are running a few checks on your resource</executionText>
    <noResultText>This check completed without reporting any problems</noResultText>
    <timeoutText>This check was taking too long, so we stopped the operation</timeoutText>
    <symptomId>CannotRdpAzurePortalInsight,CannotRdpLRDAzurePortalInsight,AllowMemoryDump
</symptomId>
    <maxInsightCount>5</maxInsightCount>
    <additionalInputsReq>false</additionalInputsReq>
</insight>
# This is the title of the article. It is not displayed in the portal but is a required part of every article: Troubleshoot my Network Security Group (NSG)

4 out of 5 customers resolved their VM Network Security Group issue using the steps below.<br>

## **Recommended Steps**

NSGs by default deny connections from the Internet unless it is explicitly allowed. To resolve this issue, try one or more of the below steps:
Try using [Azure Bastion](https://docs.microsoft.com/azure/bastion/bastion-overview) to connect to your VM.  [Azure Bastion](https://docs.microsoft.com/azure/bastion/bastion-overview) provides secure and seamless RDP connectivity to your virtual machine directly in the Azure portal over TLS. When you connect via Azure Bastion, your virtual machine does not need a public IP address, or inbound NSG rule allowing RDP traffic.
1. Use [IP flow verify](data-blade:microsoft_azure_network.verifyipflowblade.id.$subscriptionId) to confirm if a rule in a Network Security Group is blocking traffic to or from a virtual machine
2. Edit the [Network Security Group](https://docs.microsoft.com/azure/virtual-network/manage-network-security-group) to make changes to the rules if needed.
3. If there is no rule to allow remote RDP traffic, review [Unable to connect via RDP due to NSG](https://docs.microsoft.com/azure/virtual-machines/troubleshooting/troubleshoot-rdp-nsg-problem)<br>
4. If there is no rule to allow the traffic from Internet, add a new rule to allow access to the backend port, with source being 'Internet', '\*' or a specific public IP address


## **Recommended Documents**

* [How to troubleshoot Network Security Groups (NSGs)](https://blogs.msdn.microsoft.com/mvpawardprogram/2018/05/08/troubleshoot-nsgs)<br>
* [How to configure Network Watcher to troubleshoot NSG issues](https://docs.microsoft.com/azure/network-watcher/network-watcher-create)<br>
* [How to read NSG logs generated from Network Watcher](https://docs.microsoft.com/azure/network-watcher/network-watcher-read-nsg-flow-logs)<br>
* [Filter network traffic with a network security group using the Azure Portal](https://docs.microsoft.com/azure/virtual-network/tutorial-filter-network-traffic)

### Notes

* The **Recommended Steps** and **Recommended Documents** headings must be entered as shown above (bolded H2)
* Formatting is not identical to Microsoft Docs - tables do not work, nor [!NOTE] tags
* Your Recommended Steps should be actual steps, not just links to other articles
* Ensure all links to Microsoft docs are non-region-specific, i.e. does not include /en-us/. This does not apply to articles for Mooncake.
* Don't link to internal review documentation - these URLs always start with "review.microsoft.docs", and users are unable to access them
* Do not use aka.ms links
* Copy the raw form of this article to use as a template for your own Common Solution article. Be sure to fill in the metadata!