<properties
  pagetitle="Resolve Metrics issues "
  description=""
  service=""
  resource=""
  ms.author="zhizhwan"
  selfhelptype="apollo"
  supporttopicids="641d0934-4278-08bb-21fc-685a9509dc36"
  productpesids="13491"
  cloudenvironments="public,fairfax,mooncake,blackforest,ussec,usnat"
  disableclouds=""
  articleid="245522f7-c21f-4565-92ba-a9ad56ee762c"
  ownershipid="AzureData_AzureSQLDB_Performance"
  resourcerequired="True" />
# Resolve Metrics issues with Azure SQL Database

The Azure Portal enables monitoring of resource metrics for your Azure SQL Database. You can quickly monitor a variety of resource metrics, enabling you to see resource consumption at any given moment.

You can configure diagnostic settings to [stream categories of metrics and resource logs](https://docs.microsoft.com/azure/azure-sql/database/metrics-diagnostic-telemetry-logging-streaming-export-configure?tabs=azure-portal#diagnostic-telemetry-for-export) for single databases, pooled databases, and elastic pools to one of the following Azure resources:
- [Log Analytics](https://docs.microsoft.com/azure/azure-monitor/platform/resource-logs#collect-to-log-analytics-workspace)
  - Can be consumed by [SQL Analytics](https://docs.microsoft.com/azure/azure-monitor/insights/azure-sql)
  - Leverage other Azure Monitor features, such as alerts and visualizations
- [Azure Event Hubs](https://docs.microsoft.com/azure/azure-monitor/platform/resource-logs#send-to-azure-event-hubs)
  - Stream logs to third-party logging and telemetry systems
  - Build a custom telemetry and logging platform
  - View service health by streaming data to Power BI
- [Azure Storage](https://docs.microsoft.com/azure/azure-monitor/platform/resource-logs#send-to-azure-storage)
  - Store data for longer periods
  - Low cost storage

You can enable and manage metrics and diagnostic telemetry logging by using one of the following methods:
- Azure Portal
- PowerShell
- Azure CLI
- Azure Monitor REST API
- Azure Resource Manager template

## **Recommended Steps**

### SQL Metrics Diadnostics

<insight>
    <executionText>We are running a few checks on your resource</executionText>
    <noResultText>This check completed without reporting any problems</noResultText>
    <timeoutText>This check was taking too long, so we stopped the operation</timeoutText>
    <maxInsightCount>3</maxInsightCount>
    <additionalInputsReq>false</additionalInputsReq>
    <symptomId>SqlMetrics</symptomId>
</insight>

:::Section Log Analytics workspace doesn't have metrics data:::

### Log Analytics workspace doesn't have metrics data you configured in Diagnostic Logs

:::Section What are the supported metrics for Azure SQL Database:::
### Supported metrics 

- [Platform metrics: Databases](https://docs.microsoft.com/azure/azure-monitor/platform/metrics-supported#microsoftsqlserversdatabases)
- [Platform metrics: Elastic pools](https://docs.microsoft.com/azure/azure-monitor/platform/metrics-supported#microsoftsqlserverselasticpools)


:::Section How to monitor performance metrics:::


:::Section How to monitor metrics for Geo-secondary:::


:::Section "Error retrieving data" message on dashboard:::


:::Section How to digest the metrics:::
1. You can export the metrics to outside of Azure
  - The metrics can be [streamed](https://docs.microsoft.com/azure/azure-sql/database/metrics-diagnostic-telemetry-logging-streaming-export-configure?tabs=azure-portal#diagnostic-telemetry-for-export) to Azure Event Hubs and Azure Storage, from where they can be sent outside of Azure
  - On the Metrics tab, you can download the metrics presented to Excel. Select **Share** > **Download to Excel**.
  - Use [REST API](https://docs.microsoft.com/rest/api/monitor/metrics/list) or [Powershell](https://docs.microsoft.com/powershell/module/az.monitor/get-azmetric?view=azps-4.7.0) to obtain the value of the metric that you want
2. You can configure alerts on the metrics to get notifications when metrics reach threshold. 

### Recommended video
In the following video, you will learn how to configure and use Azure SQL Analytics.

<video>
<src>https://youtu.be/j-NDkN4GIzg</src>
<title>Azure SQL Analytics</title>
</video>

Summary of configuration steps in the video:

1. Setting up an Azure Active Directory Admin
2. Creating logins for users
3. Examples of login types
4. Adding access to existing Active Directory users


### Resources Title <!-- Additional resources title needed -->

<!-- Include links that aren't already listed in the solution. Approved sources include: MS docs, MSDN, and Stack Overflow. -->

<!-- You can also use Markdown syntax: [Description of document](URL) -->

Here are some relevant results from the web:
<azureKB>
  <client>portal</client>
</azureKB>