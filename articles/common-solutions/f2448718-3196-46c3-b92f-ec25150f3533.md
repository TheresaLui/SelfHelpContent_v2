<properties
  pagetitle="Cannot connect to SQL Server Analysis Service"
  service="microsoft.sqlvirtualmachine"
  resource="sqlvirtualmachines"
  ms.author="babarmav"
  selfhelptype="Generic"
  supporttopicids="32779856"
  productpesids="14745"
  cloudenvironments="public, fairfax, mooncake, blackforest, ussec, usnat"
  disableclouds=""
  articleid="f2448718-3196-46c3-b92f-ec25150f3533"
  ownershipid="AzureData_AzureSQLVM" />
# Cannot connect to SQL Server Analysis Service
Most customers can resolve issues regarding Cannot connect to SQL Server Analysis Service by using following steps.

## **Recommended Steps**

- ** Where can I find the installation media or the license key in an Azure SQL VM?**
    - If you already have a SQL Server VM created from Azure Marketplace, you can find the installation media at C:\SQLServerFull
    - To get the product key, launch setup.exe from C:\SQLServerFull, copy the product key that appears in the install process, and exit the installer

-  **An error was encountered in the transport layer **
This error in general indicates clients receive transport layer error and are unable to connect to the target Analysis Services. You should check the users are able to access the target Analysis Services server by IP and port in the network, check if clients are using the supported Analysis Services client libraries, and users are granted with proper permission to the target Analysis Services databases.

- **Cannot connect to SQL Server Analysis Service**
Connecting to an Analysis Services database requires a Windows user or group identity and associated permissions. Please review the recommended documents below

    - [Authentication methodologies supported by Analysis Services](https://docs.microsoft.com/en-us/analysis-services/instances/authentication-methodologies-supported-by-analysis-services?view=asallproducts-allversions)
    - [Authorizing access to objects and operations (Analysis Services)](https://docs.microsoft.com/en-us/analysis-services/multidimensional-models/authorizing-access-to-objects-and-operations-analysis-services?view=asallproducts-allversions)

-Error with Kerberos delegation. 
Kerberos delegation is required if the user identity has to flow over multiple computer connections (known as "double-hop"). When Analysis Services data access is contingent upon user identity, and the connection request is from a delegating service, use the checklist in the next section to ensure that Analysis Services is able to impersonate the original caller.






## **Recommended Documents**

- [Connect to SQL Server Analysis Services ](https://docs.microsoft.com/en-us/analysis-services/instances/authentication-methodologies-supported-by-analysis-services?view=asallproducts-allversions)

- [Analysis Services Client libraries] (https://docs.microsoft.com/en-us/analysis-services/client-libraries?view=asallproducts-allversions)

- [Configure the Windows Firewall to allow Analysis Services Access] (https://docs.microsoft.com/en-us/analysis-services/instances/configure-the-windows-firewall-to-allow-analysis-services-access?view=asallproducts-allversions)

- [Resolving Common Connectivity Issues in SQL Server 2005 Analysis Services Connectivity Scenarios](https://docs.microsoft.com/en-us/previous-versions/sql/sql-server-2005/administrator/cc917670(v=technet.10)?redirectedfrom=MSDN). This document is a few years old, but the information and methodologies still apply.