<properties
  pagetitle="Modules or downstream devices connection fails with certificate validation errors."
  service="microsoft.devices"
  resource="iothubs"
  ms.author="darobs"
  selfhelptype="Generic"
  supporttopicids="32680943"
  productpesids="16509"
  cloudenvironments="public, fairfax, mooncake, blackforest, ussec, usnat"
  articleid="79ee1dc2-831b-40ef-81d2-efc80ce17bd0"
  ownershipid="AzureIot_IotEdge" />
# Modules or downstream devices connection fails with certificate validation errors.

All IoT Edge devices use certificates to create secure connections between the runtime and any modules running on the device. 
Below are some debugging tips for finding problems with certificates.

## **Recommended Steps**

1. Run `iotedge check`. This tool has specific checks and recommendations for certificate settings. 
2. Make sure the `hostname` setting in `/etc/iotedge/config.yaml` is a hostname and not an ip address
3. For a private IoT Hub, the root CA for the private hub needs to be added to the trust bundle provided in `certificates.trusted_ca_certs`. For more information, please read [Manage certificates on an IoT Edge device](https://docs.microsoft.com/azure/iot-edge/how-to-manage-device-certificates).
4. Modules get the trust bundle from the Azure Security Daemon (iotedged).  If the certificates have been modified or updated in iotedged, the modules may need to be restarted to get the new trust bundle.

```
iotedge restart <module>
```

## **Recommended Documents**

* [Understand how Azure IoT Edge uses certificates.](https://docs.microsoft.com/azure/iot-edge/iot-edge-certs)

In addition, most users can find relevant information from a large knowledge base of public resources below. Consider utilizing these channels for non-blocking incidents. 
 
* Prior issues at [azure/iotedge GitHub repository](https://github.com/azure/iotedge/issues?q=is%3Aissue+) 
    * Issues in the repo are monitored by the IoT Edge product team 
 
* Stack Overflow questions tagged [azure-iot-edge](https://stackoverflow.com/questions/tagged/azure-iot-edge) 
* Previously answered [Azure Docs issues](https://github.com/MicrosoftDocs/azure-docs/issues?q=is%3Aissue+label%3Aiot-edge%2Fsvc+)
* [IoT Edge Q&A portal](https://docs.microsoft.com/answers/topics/azure-iot-edge.html?WT.mc_id=Portal-Microsoft_Azure_Support)
