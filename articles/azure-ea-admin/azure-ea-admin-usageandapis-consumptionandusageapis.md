<properties
	pageTitle="Consumption and usage APIs"
	description="Providing users with information about usage APIs"
	infoBubbleText=""
	service="microsoft.enterpriseagreement"
	resource="enrollmentmanagement"
    authors="irinakolontaev1"
	ms.author="baolcsva"
	displayOrder=""
	articleId="95831635-3f61-4cfb-957f-c9fc5f40eb46"
	diagnosticScenario=""
	selfHelpType="generic"
	supportTopicIds="32688681"
	resourceTags=""
	productPesIds="16867"
	cloudEnvironments="public, fairfax, usnat, ussec"
	ownershipId="AzureEA_SelfDeflectionContent"
/>

# Consumption and usage APIs

Microsoft Enterprise Azure customers can get usage and billing information through REST APIs. The role owner (Enterprise Administrator, Department Administrator, Account Owner) must enable access to the API by generating a key from the Azure EA portal. Then, anyone provided with the enrollment number and key can access the data through the API.

### Available APIs

* **Balance and Summary:** The [Balance and Summary API](https://docs.microsoft.com/azure/billing/billing-enterprise-api-balance-summary) provides a monthly summary of information about balances, new purchases, Azure Marketplace service charges, adjustments, and overage charges
* **Usage Detail:** The [Usage Detail API](https://docs.microsoft.com/azure/billing/billing-enterprise-api-usage-detail) provides a daily breakdown of consumed quantities and estimated charges by an enrollment. The result also includes information about instances, meters, and departments. You can query the API by billing period or by a specified start and end date. 
* **Marketplace Store Charge:** The [Marketplace Store Charge API](https://docs.microsoft.com/azure/billing/billing-enterprise-api-marketplace-storecharge) returns usage-based marketplace charges, broken down day for the specified billing period or start and end dates
* **Price Sheet:** The [Price Sheet API](https://docs.microsoft.com/azure/billing/billing-enterprise-api-pricesheet) provides the applicable rate for each meter for an enrollment and billing period
* **Billing Periods:** The [Billing Periods API](https://docs.microsoft.com/azure/billing/billing-enterprise-api-billing-periods) returns a list of billing periods that have consumption data for an enrollment in reverse chronological order. Each period contains a property pointing to the API route for the four sets of data, BalanceSummary, UsageDetails, Marketplace Charges, and PriceSheet.

### Enable API data access

Role owners can perform the following steps in the Azure EA portal. Navigate to **Reports** > **Download Usage** > **API Access Key**. Then they can:

- Generate primary and secondary access keys
- Disable access keys
- View start and end dates of access keys

### Generate or retrieve the API Key

1. Sign in as an enterprise administrator
1. Click **Reports** on the left navigation window and then click the **Download Usage** tab
1. Click **API Access Key**
1. Under **Enrollment Access Keys**, select the generate key symbol to generate either a primary or secondary key
1. Select **Expand Key** to view the entire generated API access key
1. Select **Copy** to get the API access key for immediate use

If you want to give the API access keys to people who aren't enterprise administrators in your enrollment, perform the following steps:

1. In the left navigation window, click **Manage**
1. Click the pencil symbol next to **DA view charges** (Department Administrator view charges)
1. Select **Enable** and then click **Save**
1. Click the pencil symbol next to **AO view charges** (Account Owner view charges)
1. Select **Enable** and then click **Save**

The preceding steps give API access key holders with access to cost and pricing information in usage reports.

### Common API issues

As you use Azure Enterprise REST APIs, you might encounter any of the following common issues.

- You might try to use an API key that doesn't have the correct authorization type. API keys are generated by:
  - Enterprise Administrator
  - Department Administrator (DA)
  - Account Owner (AO)
  
- A key generated by the EA admin gives access to all information for that enrollment. A read-only EA admin can't generate an API key.
- A key generated by a DA or AO doesn't provide access to balance, charge, and price sheet information
- An API key expires every six months. If expired, you need to regenerate it.
- If you receive a timeout error, you can resolve it by increasing the timeout threshold limit
- You might receive a 401 error (unauthorized) expiration error. The error is usually caused by an expired key. If the key is expired, you can regenerate it.
- You might receive 400 and 404 (unavailable) errors returned from an API call when there's no current data available for the date range selected. For example, this error might occur because an enrollment transfer was recently initiated. Data from a specific date and later now resides in a new enrollment. On the other hand, the error might occur if you're using a new enrollment number to retrieve information that resides in an old enrollment.

## **Recommended Documents**

- [Overview of Reporting APIs for Enterprise customers](https://docs.microsoft.com/azure/billing/billing-enterprise-api)
- [REST API Browser](https://docs.microsoft.com/rest/api/?view=Azure)
- [Azure Billing REST API](https://docs.microsoft.com/rest/api/billing/)
- [Azure Billing API Overview](https://docs.microsoft.com/azure/billing/billing-usage-rate-card-overview#azure-resource-ratecard-api-preview)
- [Azure Invoice Download API](https://docs.microsoft.com/azure/billing/billing-usage-rate-card-overview#azure-invoice-download-api-preview)
- [Azure Resource Usage API](https://docs.microsoft.com/azure/billing/billing-usage-rate-card-overview#azure-resource-usage-api-preview)
- [Azure Resource RateCard API](https://docs.microsoft.com/azure/billing/billing-usage-rate-card-overview#azure-resource-ratecard-api-preview)
